{% extends '../base.html' %}
{% load mptt_tags %}

<!--    Page content      -->

{% block content %}
<div class="row">  
    <ul class="list-group col-lg-2 col-md-4  bg-secondary pr-0">
        {% full_tree_for_model CaptainConsole.Category as gs %}
        {% for node, structure in gs|tree_info %}
            <li>
                <a href="/category/{{ node.get_slug_link }}" class="{% if node.is_leaf_node %}child_node{%endif%} list-group-item bg-secondary border-warning rounded-0 list-group-item-action">
                    {{ node }}
                </a>
            </li>
        {% endfor %}

        
        </ul>
    <main class="container col-lg-10 col-md-8 pt-3">

        <!-- ADD SIDEBAR HERE FOR CATEGORIES -->
        <h2>Products list</h2>
        <section class="container d-flex flex-wrap">
            {% for product in products %}
            
                <!-- Single product cards-->
                <div class="card my-3 mx-3 shadow-sm rounded" style="width: 18rem;">
                    <!-- CARD IMAGE -->
                    <a href="/product/{{product.id}}/{{product.slug}}" ><img src="{{product.thumb.url}}" class="card-img-top img-fluid" alt="..."></a>
                    <!-- CARD TEXT -->
                    <div class="card-body text-center ">
                        <a href="/product/{{product.id}}/{{product.slug}}" >{{ product.name }}</a>
                        <p class="font-weight-bold blue-text">{{ product.price }}$ </p>
                        
                        <form method="POST" action="{% url 'add_to_cart' product.id %}">
                            <fieldset class="row" data-toggle="buttons">
                                {% csrf_token %}
                                {{ add_to_cart_form }}
                                <input type="submit" class="btn btn-secondary col-6 border border-primary" value="Add to cart">
                                <input type="button" class="btn btn-secondary col-6 border border-primary" value="Share">
                            </fieldset>
                        </form>
                    </div>
                            
                </div>
            {% endfor %}
        </section>

        <div class="pagination">
            <span class="step-links">
                {% if products.has_previous %}
                    <a href="?page=1">&laquo; first</a>
                    <a href="?page={{ products.previous_page_number }}">previous</a>
                {% endif %}

                <span class="current">
                    Page {{ products.number }} of {{ products.paginator.num_pages }}.
                </span>

                {% if products.has_next %}
                    <a href="?page={{ products.next_page_number }}">next</a>
                    <a href="?page={{ products.paginator.num_pages }}">last &raquo;</a>
                {% endif %}
            </span>
        </div>
    </main>
{% endblock %}
